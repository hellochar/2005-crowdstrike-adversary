(this["webpackJsonp2005-crowdstrike-adversary"]=this["webpackJsonp2005-crowdstrike-adversary"]||[]).push([[0],{21:function(e,t,a){},24:function(e,t,a){},25:function(e,t,a){"use strict";a.r(t);var n=a(6),r=a(3),i=a.n(r),s=a(10),o=a.n(s),c=(a(21),a(11)),d=a(0),h=a(2),l=a(8),u=a(15),v=a(14),m=a(1),f=a(13);a(24);var g=function(e){var t=e.onGotImage,a=Object(r.useCallback)((function(e,a,n){e.forEach((function(e){var a=new FileReader;a.onabort=function(){return console.log("file reading was aborted")},a.onerror=function(){return console.log("file reading has failed")},a.onload=function(){var e=document.createElement("img");e.src=a.result,t(e)},a.readAsDataURL(e)}))}),[t]),i=Object(v.a)({onDrop:a,maxFiles:1}),s=i.getRootProps,o=i.getInputProps,c=i.isDragActive;return Object(n.jsxs)("div",Object(l.a)(Object(l.a)({className:"dropzone"},s()),{},{children:[Object(n.jsx)("input",Object(l.a)({},o())),c?Object(n.jsx)("p",{children:"Drop the files here ..."}):Object(n.jsx)("p",{children:"Drag 'n' drop some files here, or click to select files"})]}))},w=function(e){var t=e.img,a=Object(r.useRef)(),s=i.a.useCallback((function(e){null!=e&&(a.current=new p(e))}),[]);return Object(r.useEffect)((function(){null!=a.current&&null!=t&&a.current.setImage(t)}),[t]),Object(n.jsx)("canvas",{ref:s})},p=function(){function e(t){var a=this;Object(d.a)(this,e),this.canvas=t,this.renderer=void 0,this.scene=void 0,this.camera=void 0,this.controls=void 0,this.adversary=void 0,this.adversaryMaterial=void 0,this.timeStarted=0,this.geom=new m.l(200,200,512,512),this.handleWindowResize=function(){a.renderer.setSize(window.innerWidth,window.innerHeight),a.camera.aspect=window.innerWidth/window.innerHeight,a.camera.updateProjectionMatrix()},this.animate=function(){var e,t,n;requestAnimationFrame(a.animate),a.controls.update(),null!=a.adversaryMaterial&&(a.adversaryMaterial.displacementScale=50*(e=0,t=5e3,n=performance.now()-a.timeStarted,(n=m.h.clamp((n-e)/(t-e),0,1))*n*(3-2*n))),a.renderer.render(a.scene,a.camera)},this.renderer=new m.u({canvas:t}),this.renderer.setPixelRatio(window.devicePixelRatio),this.scene=new m.n,this.camera=new m.k(75,window.innerWidth/window.innerHeight,1,2e3),this.camera.position.set(150,0,150),this.camera.lookAt(0,0,0),this.handleWindowResize(),window.addEventListener("resize",this.handleWindowResize),this.scene.add(new m.a(4210752));var n=new m.d(11711393,2);n.position.set(0,0,10),this.scene.add(n),this.scene.background=new m.c(1,1,1),this.loadDefaultImage(),this.controls=new f.a(this.camera,this.canvas),this.controls.autoRotate=!0,requestAnimationFrame(this.animate)}return Object(h.a)(e,[{key:"setImage",value:function(e){var t=new m.q(e);e.onload=function(){t.needsUpdate=!0},this.recreateAdversary(t)}},{key:"recreateAdversary",value:function(e){var t;null!=this.adversary&&(this.scene.remove(this.adversary),null===(t=this.adversaryMaterial)||void 0===t||t.dispose());var a=function(e){var t=e.image,a=document.createElement("canvas");a.width=t.width/3,a.height=t.height/3;var n=a.getContext("2d");if(n){n.drawImage(t,0,0,a.width,a.height);for(var r=a.width,i=a.height,s=n.getImageData(0,0,r,i),o=0;o<s.data.length;o+=4){var c=.2126*(s.data[o]/255)+.7152*(s.data[o+1]/255)+.0722*(s.data[o+2]/255);s.data[o]=s.data[o+1]=s.data[o+2]=Math.floor(255*c)}return n.putImageData(s,0,0),new m.b(a)}}(e);this.adversaryMaterial=new m.j({side:m.e,map:e,displacementMap:a,displacementScale:0,roughness:.5,metalness:0}),this.adversary=new m.i(this.geom,this.adversaryMaterial),this.scene.add(this.adversary),this.renderer.render(this.scene,this.camera),this.timeStarted=performance.now()}},{key:"loadDefaultImage",value:function(){var e=this;(new m.r).load("adversaries/Buffalo.jpg",(function(t){e.recreateAdversary(t)}),(function(e){return console.log(e)}),(function(e){return console.error(e)}))}},{key:"generateDisplacementMappedGeometry",value:function(e){var t=document.createElement("canvas");t.width=e.width/10,t.height=e.height/10;var a=t.getContext("2d");if(a){a.drawImage(e,0,0,t.width,t.height);var n,r=t.width,i=t.height,s=a.getImageData(0,0,r,i),o=new m.l(r-1,i-1,r-1,i-1),d=Object(c.a)(o.vertices);try{for(d.s();!(n=d.n()).done;){var h=n.value,l=4*(m.h.mapLinear(h.x-.5,-r/2,r/2,0,r)+r*m.h.mapLinear(h.y-.5,i/2,-i/2,0,i)),u=.2126*(s.data[l]/255)+.7152*(s.data[l+1]/255)+.0722*(s.data[l+2]/255);h.z=20*u}}catch(f){d.e(f)}finally{d.f()}var v=200/Math.max(r,i);return o.scale(v,v,1),o.computeFlatVertexNormals(),o}}}]),e}();var j=function(){var e=Object(r.useState)(),t=Object(u.a)(e,2),a=t[0],i=t[1];return Object(n.jsxs)("div",{className:"App",children:[Object(n.jsx)(w,{img:a}),Object(n.jsx)(g,{onGotImage:i})]})},b=function(e){e&&e instanceof Function&&a.e(3).then(a.bind(null,26)).then((function(t){var a=t.getCLS,n=t.getFID,r=t.getFCP,i=t.getLCP,s=t.getTTFB;a(e),n(e),r(e),i(e),s(e)}))};o.a.render(Object(n.jsx)(i.a.StrictMode,{children:Object(n.jsx)(j,{})}),document.getElementById("root")),b()}},[[25,1,2]]]);
//# sourceMappingURL=main.21e8e027.chunk.js.map